%% 自動學習流程圖
flowchart TD
  A[資料進入：雙語文件/修正/TM] --> B[清洗與去噪]
  B --> C[術語抽取]
  C --> D[自動分類]
  D --> E[自動升級]
  E --> F[Glossary/TM/候選池]
  F --> G[翻譯與抽取回饋]
  G --> H[監控與自動調參]
  H --> B

  subgraph 升級邏輯
    E1[計算候選分數]
    E2[升級到 TM]
    E3[升級到 Glossary]
    E1 --> E2
    E1 --> E3
  end

  E --> E1

%% 執行期資料流
flowchart TD
  U[使用者修正翻譯] --> FB[/api/tm/feedback]
  FB --> TF[(term_feedback)]
  TF --> AUTO{次數 >= 門檻}
  AUTO -- 是 --> GL[(glossary)]
  AUTO -- 否 --> TF

  TR[翻譯完成] --> SAVE[save_tm]
  SAVE --> TM[(tm)]
  TM --> HIT[lookup_tm]
  HIT --> OUT[翻譯輸出]
