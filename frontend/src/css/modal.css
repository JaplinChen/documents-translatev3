/* === Modal Styles === */
@layer components {

    /* Modal Overlay (Glassy) */
    .modal-overlay,
    .modal-backdrop {
        @apply fixed inset-0 bg-slate-900/40 backdrop-blur-md z-50 flex items-center justify-center;
        animation: fadeIn 0.3s ease-out;
    }

    .modal {
        background-color: var(--glass-bg-deep);
        backdrop-filter: blur(var(--glass-blur));
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        @apply shadow-2xl flex flex-col gap-2;
        border: 1px solid var(--glass-border);
        width: min(720px, 94vw);
        max-height: 85vh;
        animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    /* Draggable Modal */
    .modal.is-draggable {
        position: absolute;
        resize: both;
        overflow: auto;
        min-width: 600px;
        width: min(1000px, 96vw);
        min-height: 400px;
        max-width: 98vw;
        max-height: 95vh;
    }

    .modal.is-draggable.is-manage {
        overflow: auto;
        min-width: 760px;
        width: min(1000px, 96vw);
        height: min(720px, 85vh);
        min-height: 400px;
    }

    .modal.is-draggable.is-settings {
        @apply p-0 overflow-hidden;
        min-width: 760px;
        min-height: 520px;
        width: min(1200px, 94vw);
        height: min(820px, 90vh);
    }

    .modal.is-draggable.is-settings .settings-shell {
        @apply h-full;
    }

    .modal.is-draggable.is-settings .settings-main {
        @apply min-h-0;
    }

    .modal.is-draggable.is-settings .settings-content {
        @apply min-h-0;
    }

    .modal.is-draggable.is-settings .modal-header.draggable-handle {
        @apply bg-slate-50/90 border border-slate-200/70 rounded-xl px-3 py-2;
    }

    .modal.is-draggable.is-manage .modal-body {
        @apply flex flex-col min-h-0 overflow-auto;
        flex: 1 1 auto;
    }

    .modal.is-draggable.is-manage .manage-body {
        @apply flex flex-col min-h-0 overflow-auto;
        flex: 1 1 auto;
    }

    .modal.is-draggable.is-manage .modal-header.draggable-handle {
        @apply bg-slate-50/90 border border-slate-200/70 rounded-xl px-3 py-2;
    }

    .modal.is-draggable .modal-header.draggable-handle {
        cursor: grab;
        user-select: none;
    }

    .modal.is-draggable .modal-header.draggable-handle:active {
        cursor: grabbing;
    }

    .modal-content {
        background-color: var(--bg-card);
        backdrop-filter: blur(var(--glass-blur));
        border-radius: var(--radius-2xl);
        @apply shadow-2xl overflow-hidden flex flex-col;
        border: 1px solid var(--glass-border);
        width: min(900px, 94vw);
        height: 80vh;
        animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .modal-wide {
        @apply max-w-5xl w-[92vw];
    }

    .modal-header {
        @apply flex justify-between items-center pb-2 border-b border-slate-200;
    }

    .modal-header.fancy {
        @apply flex justify-between items-center pb-4 mb-4 border-b border-slate-200;
    }

    .modal-header.fancy h3 {
        @apply text-xl font-bold text-slate-800 m-0;
    }

    .modal-body {
        @apply py-0 px-1 overflow-y-auto;
    }

    .modal-tabs {
        @apply flex gap-1 p-1 mb-0 self-start;
        background-color: var(--state-pending-bg);
        border-radius: var(--radius-md);
    }

    .tab-btn {
        @apply px-4 py-2 text-sm font-semibold transition-all duration-200;
        border-radius: var(--radius-md);
        color: var(--text-muted);
    }

    .tab-btn:hover {
        color: var(--text-heading);
        background-color: var(--bg-hover);
    }

    .tab-btn.is-active {
        background-color: var(--bg-card);
        color: var(--accent);
        @apply shadow-sm;
    }

    .header-title {
        @apply flex-1;
    }

    .header-title h3 {
        @apply text-xl font-bold text-slate-800 m-0;
    }

    .header-actions {
        @apply flex gap-2 items-center;
    }

    /* Settings Shell */
    .settings-shell {
        @apply flex flex-1 min-h-0;
    }

    .settings-sidebar {
        @apply w-60 bg-slate-50 border-r border-slate-200 p-5 flex flex-col gap-2;
    }

    .settings-main {
        @apply flex-1 p-8 overflow-y-auto;
    }

    .settings-content {
        @apply flex flex-col gap-6;
    }

    /* Sidebar Components */
    .sidebar-title {
        @apply text-sm font-bold text-slate-800 uppercase tracking-wider mb-4;
    }

    .sidebar-tabs {
        @apply grid grid-cols-2 gap-2 pb-4 mb-4 border-b border-slate-200;
    }

    .sidebar-tab {
        @apply flex items-center justify-center px-2 py-2 text-[11px] font-bold rounded-xl cursor-pointer transition-all;
        @apply bg-slate-100 text-slate-500 border border-slate-200/50 hover:bg-white hover:text-slate-700 hover:shadow-sm;
    }

    .sidebar-tab.active {
        @apply bg-blue-600 text-white;
    }

    .sidebar-list {
        @apply flex flex-col gap-1;
    }

    .sidebar-item {
        @apply flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-slate-500 cursor-pointer transition-all duration-200;
        @apply hover:bg-white hover:text-slate-700;
    }

    .sidebar-item.active {
        @apply bg-white text-blue-600 shadow-sm font-semibold;
    }

    .sidebar-icon {
        @apply w-8 h-8 flex items-center justify-center text-lg rounded-lg bg-slate-100;
    }

    .sidebar-text {
        @apply flex flex-col;
    }

    .sidebar-name {
        @apply text-sm font-semibold text-slate-700;
    }

    .sidebar-sub {
        @apply text-xs text-slate-400;
    }

    .sidebar-empty {
        @apply text-sm text-slate-400 py-4 text-center;
    }

    /* Config Fields */
    .config-field {
        @apply flex flex-col gap-2;
    }

    .config-field.compact {
        @apply gap-1.5;
    }

    .config-field label {
        @apply text-sm font-semibold text-slate-700;
    }

    .config-field input[type="text"],
    .config-field input[type="password"],
    .config-field select {
        @apply w-full h-10 px-3 rounded-lg border border-slate-200 bg-white text-sm text-slate-800;
        @apply focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-all duration-200;
    }

    .model-select {
        @apply w-full h-10 px-3 rounded-lg border border-slate-200 bg-white text-sm text-slate-800 focus:outline-none focus:border-blue-500;
    }

    .color-grid {
        @apply grid grid-cols-3 gap-4;
    }

    .color-item {
        @apply flex flex-col gap-2;
    }

    .color-item span {
        @apply text-sm font-medium text-slate-600;
    }

    /* Prompt Editor */
    .prompt-editor-container {
        @apply flex flex-col gap-4;
    }

    .prompt-selector-row {
        @apply flex items-center gap-3;
    }

    .prompt-selector-label {
        @apply text-sm font-semibold text-slate-700 whitespace-nowrap;
    }

    .prompt-template-select {
        @apply flex-1 h-10 px-3 rounded-lg border border-slate-200 bg-white text-sm focus:outline-none focus:border-blue-500;
    }

    .prompt-textarea {
        @apply w-full min-h-64 p-4 text-sm font-mono leading-relaxed resize-none;
        border-radius: var(--radius-md);
        border: 1px solid var(--border-soft);
        background-color: var(--bg-main);
        @apply focus:outline-none transition-all duration-200;
    }

    .prompt-textarea:focus {
        border-color: var(--accent);
        background-color: var(--bg-card);
        box-shadow: 0 0 0 2px var(--accent-soft);
    }

    .correction-preview-grid {
        background-repeat: repeat;
    }

    .correction-preview-box {
        border-radius: 12px;
        transform: rotate(-1deg);
    }

    .layouts-tab {
        @apply flex flex-col gap-4;
    }

    .layouts-overview {
        @apply rounded-2xl p-4 flex flex-col gap-3 md:flex-row md:items-start md:justify-between;
        border: 1px solid #dbeafe;
        background: linear-gradient(135deg, #eff6ff 0%, #f8fafc 55%, #eef2ff 100%);
    }

    .layouts-overview-title {
        @apply text-lg font-bold text-slate-800;
    }

    .layouts-overview-subtitle {
        @apply text-sm text-slate-600 mt-1;
    }

    .layouts-overview-stats {
        @apply flex flex-wrap gap-2;
    }

    .layouts-stat-chip {
        @apply rounded-xl px-3 py-2 border border-blue-100 bg-white/80 min-w-[120px];
    }

    .layouts-stat-label {
        @apply block text-[11px] font-semibold text-slate-500;
    }

    .layouts-stat-value {
        @apply block text-lg font-extrabold text-blue-700 leading-tight;
    }

    .layouts-toolbar-card {
        @apply rounded-2xl border border-slate-200 bg-white p-4 flex flex-col gap-2;
    }

    .layouts-toolbar-grid {
        @apply grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-3 items-end;
    }

    .layouts-action-btn {
        @apply h-10 w-full;
    }

    .layouts-main-grid {
        @apply grid grid-cols-1 xl:grid-cols-12 gap-4;
    }

    .layouts-panel-card {
        @apply rounded-2xl border border-slate-200 bg-white p-4 flex flex-col gap-3;
    }

    .layouts-main-grid>.layouts-panel-card:first-child {
        @apply xl:col-span-4;
    }

    .layouts-main-grid>.layouts-panel-card:last-child {
        @apply xl:col-span-8;
    }

    .layouts-panel-title {
        @apply text-sm font-bold text-slate-800;
    }

    .layouts-form-stack {
        @apply flex flex-col gap-3;
    }

    .layouts-create-btn {
        @apply w-full;
    }

    .layouts-list-header {
        @apply flex flex-col gap-2 md:flex-row md:items-center md:justify-between;
    }

    .layouts-search-input {
        @apply md:w-72;
    }

    .layouts-list {
        @apply flex flex-col gap-2 max-h-[420px] overflow-auto pr-1;
    }

    .layouts-item-card {
        @apply rounded-xl border border-slate-200 bg-slate-50/80 p-3 flex flex-col gap-3 md:flex-row md:items-center md:justify-between;
    }

    .layouts-item-title-row {
        @apply flex items-center gap-2;
    }

    .layouts-item-title {
        @apply text-sm font-semibold text-slate-700 truncate;
    }

    .layouts-item-id {
        @apply text-xs text-slate-500 mt-1 truncate;
    }

    .layouts-item-state {
        @apply text-[11px] font-bold px-2 py-0.5 rounded-full border;
    }

    .layouts-item-state.is-on {
        @apply text-emerald-700 bg-emerald-50 border-emerald-200;
    }

    .layouts-item-state.is-off {
        @apply text-slate-600 bg-slate-100 border-slate-200;
    }

    .layouts-item-actions {
        @apply flex flex-wrap gap-2;
    }

    .layouts-message {
        @apply text-sm font-medium rounded-xl px-3 py-2 border;
    }

    .layouts-message.is-success {
        @apply text-emerald-700 bg-emerald-50 border-emerald-200;
    }

    .layouts-message.is-error {
        @apply text-rose-700 bg-rose-50 border-rose-200;
    }
}

/* === Animations === */
@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes slideUp {
    from {
        transform: translateY(20px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}